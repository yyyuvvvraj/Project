{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{saveAs}from\"file-saver\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DataView=()=>{const[rows,setRows]=useState([]);useEffect(()=>{axios.get(\"http://localhost:5000/api/data\").then(res=>setRows(res.data)).catch(err=>console.error(err));},[]);const exportToExcel=async()=>{try{const response=await axios.get(\"http://localhost:5000/api/upload/export\",{responseType:\"blob\"});const blob=new Blob([response.data],{type:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"});saveAs(blob,\"ExportedData.xlsx\");}catch(error){console.error(\"Export failed\",error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Uploaded Data\"}),/*#__PURE__*/_jsx(\"button\",{onClick:exportToExcel,className:\"bg-green-500 text-white px-4 py-2 rounded mb-4\",children:\"Export to Excel\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:rows[0]&&Object.keys(rows[0]).map(key=>/*#__PURE__*/_jsx(\"th\",{className:\"py-2 px-4 border-b text-left\",children:key},key))})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map((row,index)=>/*#__PURE__*/_jsx(\"tr\",{className:\"border-b\",children:Object.values(row).map((value,idx)=>/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4\",children:String(value)},idx))},index))})]})]});};export default DataView;","map":{"version":3,"names":["React","useEffect","useState","axios","saveAs","jsx","_jsx","jsxs","_jsxs","DataView","rows","setRows","get","then","res","data","catch","err","console","error","exportToExcel","response","responseType","blob","Blob","type","className","children","onClick","Object","keys","map","key","row","index","values","value","idx","String"],"sources":["C:/Users/yuvra/Downloads/Excel Analytics/New folder/frontend/frontend/src/pages/DataView.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\nconst DataView = () => {\r\n  const [rows, setRows] = useState([]);\r\n\r\n  useEffect(() => {\r\n    axios.get(\"http://localhost:5000/api/data\")\r\n      .then((res) => setRows(res.data))\r\n      .catch((err) => console.error(err));\r\n  }, []);\r\n\r\n  const exportToExcel = async () => {\r\n    try {\r\n      const response = await axios.get(\"http://localhost:5000/api/upload/export\", {\r\n        responseType: \"blob\",\r\n      });\r\n      const blob = new Blob([response.data], {\r\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\r\n      });\r\n      saveAs(blob, \"ExportedData.xlsx\");\r\n    } catch (error) {\r\n      console.error(\"Export failed\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h2 className=\"text-xl font-bold mb-4\">Uploaded Data</h2>\r\n\r\n      <button\r\n        onClick={exportToExcel}\r\n        className=\"bg-green-500 text-white px-4 py-2 rounded mb-4\"\r\n      >\r\n        Export to Excel\r\n      </button>\r\n\r\n      <table className=\"min-w-full bg-white\">\r\n        <thead>\r\n          <tr>\r\n            {rows[0] && Object.keys(rows[0]).map((key) => (\r\n              <th key={key} className=\"py-2 px-4 border-b text-left\">{key}</th>\r\n            ))}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {rows.map((row, index) => (\r\n            <tr key={index} className=\"border-b\">\r\n              {Object.values(row).map((value, idx) => (\r\n                <td key={idx} className=\"py-2 px-4\">{String(value)}</td>\r\n              ))}\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DataView;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,MAAM,KAAQ,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEpC,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CAEpCD,SAAS,CAAC,IAAM,CACdE,KAAK,CAACS,GAAG,CAAC,gCAAgC,CAAC,CACxCC,IAAI,CAAEC,GAAG,EAAKH,OAAO,CAACG,GAAG,CAACC,IAAI,CAAC,CAAC,CAChCC,KAAK,CAAEC,GAAG,EAAKC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC,CAAC,CACvC,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAG,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAlB,KAAK,CAACS,GAAG,CAAC,yCAAyC,CAAE,CAC1EU,YAAY,CAAE,MAChB,CAAC,CAAC,CACF,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAAC,CAACH,QAAQ,CAACN,IAAI,CAAC,CAAE,CACrCU,IAAI,CAAE,mEACR,CAAC,CAAC,CACFrB,MAAM,CAACmB,IAAI,CAAE,mBAAmB,CAAC,CACnC,CAAE,MAAOJ,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,eAAe,CAAEA,KAAK,CAAC,CACvC,CACF,CAAC,CAED,mBACEX,KAAA,QAAKkB,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBrB,IAAA,OAAIoB,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAC,eAAa,CAAI,CAAC,cAEzDrB,IAAA,WACEsB,OAAO,CAAER,aAAc,CACvBM,SAAS,CAAC,gDAAgD,CAAAC,QAAA,CAC3D,iBAED,CAAQ,CAAC,cAETnB,KAAA,UAAOkB,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eACpCrB,IAAA,UAAAqB,QAAA,cACErB,IAAA,OAAAqB,QAAA,CACGjB,IAAI,CAAC,CAAC,CAAC,EAAImB,MAAM,CAACC,IAAI,CAACpB,IAAI,CAAC,CAAC,CAAC,CAAC,CAACqB,GAAG,CAAEC,GAAG,eACvC1B,IAAA,OAAcoB,SAAS,CAAC,8BAA8B,CAAAC,QAAA,CAAEK,GAAG,EAAlDA,GAAuD,CACjE,CAAC,CACA,CAAC,CACA,CAAC,cACR1B,IAAA,UAAAqB,QAAA,CACGjB,IAAI,CAACqB,GAAG,CAAC,CAACE,GAAG,CAAEC,KAAK,gBACnB5B,IAAA,OAAgBoB,SAAS,CAAC,UAAU,CAAAC,QAAA,CACjCE,MAAM,CAACM,MAAM,CAACF,GAAG,CAAC,CAACF,GAAG,CAAC,CAACK,KAAK,CAAEC,GAAG,gBACjC/B,IAAA,OAAcoB,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEW,MAAM,CAACF,KAAK,CAAC,EAAzCC,GAA8C,CACxD,CAAC,EAHKH,KAIL,CACL,CAAC,CACG,CAAC,EACH,CAAC,EACL,CAAC,CAEV,CAAC,CAED,cAAe,CAAAzB,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}